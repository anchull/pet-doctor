<div id="camera-view" class="bg-black relative h-screen w-full flex justify-center items-center overflow-hidden">
    <!-- Close Button -->
    <a href="/scan/guide" class="absolute top-4 left-4 z-20 p-2 bg-white/20 rounded-full backdrop-blur">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
    </a>

    <video id="video" autoplay playsinline class="absolute top-0 left-0 w-full h-full object-cover z-0"></video>

    <div id="guide-overlay"
        class="absolute z-10 w-full h-full pointer-events-none flex flex-col items-center justify-center">
        <!-- Scan Box -->
        <div
            class="scan-box w-16 h-80 border-4 border-green-500 rounded-lg relative flex flex-col justify-evenly items-center shadow-[0_0_0_100vh_rgba(0,0,0,0.5)]">
            <div class="scan-point w-5 h-5 border border-dashed border-white/80 rounded-full" id="pt-glu"><span
                    class="absolute right-[-80px] text-white font-bold text-sm drop-shadow-md">Glucose</span></div>
            <div class="scan-point w-5 h-5 border border-dashed border-white/80 rounded-full" id="pt-pro"><span
                    class="absolute right-[-80px] text-white font-bold text-sm drop-shadow-md">Protein</span></div>
            <div class="scan-point w-5 h-5 border border-dashed border-white/80 rounded-full" id="pt-ph"><span
                    class="absolute right-[-80px] text-white font-bold text-sm drop-shadow-md">pH</span></div>
            <div class="scan-point w-5 h-5 border border-dashed border-white/80 rounded-full" id="pt-bld"><span
                    class="absolute right-[-80px] text-white font-bold text-sm drop-shadow-md">Blood</span></div>
        </div>
        <div class="mt-4 text-white drop-shadow-md font-medium">
            동그라미에 패드를 맞춰주세요
        </div>
    </div>

    <div id="controls" class="absolute bottom-24 z-20 w-full flex justify-center">
        <div class="capture-btn w-20 h-20 bg-white rounded-full border-4 border-gray-300 cursor-pointer flex justify-center items-center active:scale-95 transition-transform"
            id="btn-scan">
            <div class="w-16 h-16 bg-blue-500 rounded-full"></div>
        </div>
    </div>
</div>

<!-- Hidden Canvas -->
<canvas id="process-canvas" class="hidden"></canvas>

<!-- Result Modal (Tailwind Style) -->
<div id="result-modal"
    class="absolute top-0 left-0 w-full h-full bg-white z-50 transform translate-y-full transition-transform duration-300 flex flex-col p-5">
    <div class="text-2xl font-bold mb-5 text-gray-800">분석 결과</div>
    <div id="results-list" class="flex-1 overflow-y-auto space-y-4">
        <!-- Results injected here -->
    </div>

    <div class="mt-auto flex gap-3">
        <button onclick="closeModal()" class="flex-1 py-4 bg-gray-200 rounded-xl font-bold text-gray-700">다시 찍기</button>
        <button onclick="saveRecord()" class="flex-1 py-4 bg-blue-600 rounded-xl font-bold text-white">결과 저장</button>
    </div>
</div>

<script type="module" src="/js/scanner.js"></script>
<script>
    function closeModal() {
        document.getElementById('result-modal').classList.remove('translate-y-0');
        document.getElementById('result-modal').classList.add('translate-y-full');
    }
    // patch for simple class toggle used in original JS
    document.getElementById('result-modal').classList.add = function (cls) {
        if (cls === 'active') {
            this.classList.remove('translate-y-full');
            this.classList.add('translate-y-0');
        }
    }
</script>